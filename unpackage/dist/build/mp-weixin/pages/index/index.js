(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"01c7":function(t,e,n){"use strict";(function(t){n("4ce3"),n("921b");a(n("66fd"));var e=a(n("d91a"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"1a87":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a,o=r(n("ea00")),i=r(n("5ee3")),s=n("52e5");function r(t){return t&&t.__esModule?t:{default:t}}var d={data:function(){return{invitationCode:"",visible:!1,toastTitle:"",toastType:"ring",showChoose:!1,menus:[],swiperIndex:0,cWidth3:"",cHeight3:"",arcbarWidth:"",pixelRatio:1,list:["canvasArcbar1","canvasArcbar2"],studyColors:["background:rgb(199,234,251)","background:rgb(232,243,210)","background:rgb(250,204,229)","background:rgb(253,235,209)"],weeks:["周日","周一","周二","周三","周四","周五","周六"],nowDay:{month:"5月2020",day:"20",week:3},weather:"--",temphigh:"--",templow:"--",weatherImg:"http://level8cases.oss-cn-hangzhou.aliyuncs.com/weathercn02/29.png",students:[],canvasText:"0",avatarImg:[n("4a3a"),n("a95a")],showStudent:{},products:[],amSubjects:[],pmSubjects:[],showStudentId:0}},computed:{isLogin:function(){return this.$store.state.login}},watch:{isLogin:function(){this.isLogin&&this.getStudent()},showStudent:{handler:function(t,e){this.getSubject()},immediate:!0}},methods:{showSQ:function(){this.$refs.sq.toggle()},goPage:function(e){this.isLogin?-1!==e.search("editTable")&&0===this.students.length?(this.toastTitle="请先添加小孩",this.toastType="none",this.$refs.toast.showLoading()):t.navigateTo({url:e}):this.showSQ()},toggleChoose:function(){this.showChoose?this.showChoose=!1:this.showChoose=!0},chooseChild:function(t){this.showStudent._id!==t._id&&(this.showStudentId=t._id,this.toggleChoose(),this.getStudentDetail())},getScope:function(){var e=this;"--"===this.weather&&t.openSetting({success:function(t){t.authSetting["scope.userLocation"]&&e.getWeather("fd775be10a2b2f19a552105a2747c07f")}})},getStudent:function(){var t=this;this.myRequest("student/findStudent",{data:{},method:"GET",contentType:"application/json"}).then((function(e){200===e.data.code&&0!==e.data.data.length&&(t.students=e.data.data,t.showStudentId=e.data.data[0]._id,t.getStudentDetail())}))},getStudentDetail:function(){var t=this,e={id:this.showStudentId};this.$refs.loading.showLoading(),this.myRequest("student/findStudentDetail",{data:e,method:"GET"}).then((function(e){if(t.$refs.loading.hideLoading(),200===e.data.code){t.showStudent=e.data.data;var n=(0,s.dateDifference)(t.showStudent.startTime,(0,s.timeFormat1)(new Date,3))/(0,s.dateDifference)(t.showStudent.startTime,t.showStudent.endTime);t.canvasText=n>=1?"100":Math.round(100*n);var a={series:[{data:n>=1?1:n,color:n>=1?"rgb(232,56,58)":"rgb(255,255,255)"}]};t.showArcbar("canvas",a)}else t.toastType="error",t.toastTitle="请求错误",t.$refs.toast.showLoading()}))},getDate:function(){this.nowDay=(0,s.timeFormat1)(new Date,0),this.getSubject()},getWeather:function(e){var n=new o.default.AMapWX({key:e});n.getRegeo({success:function(e){var n=e[0].regeocodeData.addressComponent.streetNumber.location.split(",").reverse().join(",");t.request({url:"https://jisutqybmf.market.alicloudapi.com/weather/query?city='".concat(e[0].regeocodeData.addressComponent.district,"'&location=\"").concat(n,'"'),method:"GET",header:{Authorization:"APPCODE cbd4d9a3b71d4b078ab4e8cae480f29c","content-type":"application/x-www-form-urlencoded; charset=UTF-8"},success:function(t){a.weather=t.data.result.weather,a.temphigh=t.data.result.temphigh,a.templow=t.data.result.templow,a.weatherImg="http://level8cases.oss-cn-hangzhou.aliyuncs.com/weathercn02/"+t.data.result.img+".png"}})},fail:function(t){}})},showArcbar:function(t,e){new i.default({$this:a,canvasId:t,type:"arcbar",fontSize:11,legend:{show:!1},duration:2500,pixelRatio:a.pixelRatio,series:e.series,animation:!0,width:a.cWidth3*a.pixelRatio,height:a.cHeight3*a.pixelRatio,dataLabel:!0,extra:{arcbar:{type:"circle",width:a.arcbarWidth*a.pixelRatio,ringWidth:3,labelWidth:20,startAngle:.5}}})},getSubject:function(){var t=this;if(this.showStudent._id){var e=parseInt(0==this.nowDay.week?7:this.nowDay.week),n={studentId:this.showStudent._id};this.myRequest("table/findTableByStudent",{data:n,method:"GET"}).then((function(n){if(200===n.data.code){t.amSubjects=[],t.pmSubjects=[];var a=n.data.data;for(var o in a){var i=parseInt(o.slice(0,1));if(i===e&&e<6){var s=parseInt(o.slice(1,2));s<=4&&a[o]?t.amSubjects.push(a[o]):s>4&&a[o]&&t.pmSubjects.push(a[o])}}}else t.toastType="error",t.toastTitle="请求错误",t.$refs.toast.showLoading()}))}}},onShareAppMessage:function(e){t.showShareMenu({withShareTicket:!0})},onShow:function(){1===getApp().globalData.homeChildFlag&&(getApp().globalData.homeChildFlag=0,this.getStudent())},onLoad:function(e){a=this,this.cWidth3=t.upx2px(316),this.cHeight3=t.upx2px(316),this.arcbarWidth=t.upx2px(34),this.getWeather("fd775be10a2b2f19a552105a2747c07f"),this.getDate()}};e.default=d}).call(this,n("543d")["default"])},"2b0c":function(t,e,n){},3009:function(t,e,n){"use strict";n.r(e);var a=n("8267"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},"716b":function(t,e,n){"use strict";var a=n("2b0c"),o=n.n(a);o.a},8267:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={ip:"https://api.frbkw.com/"};e.default=a},"83bf":function(t,e,n){"use strict";n.r(e);var a=n("1a87"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},b542:function(t,e,n){"use strict";n.r(e);var a=n("3009");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);var i,s,r,d,u=n("f0c5"),c=Object(u["a"])(a["default"],i,s,!1,null,null,null,!1,r,d);e["default"]=c.exports},d91a:function(t,e,n){"use strict";n.r(e);var a=n("de53"),o=n("83bf");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("716b");var s,r=n("f0c5"),d=Object(r["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],s);e["default"]=d.exports},de53:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var a={wybLoading:function(){return n.e("components/wyb-loading/wyb-loading").then(n.bind(null,"faff"))},myToast:function(){return n.e("components/my-toast/my-toast").then(n.bind(null,"c38f"))},phoneModal:function(){return Promise.all([n.e("common/vendor"),n.e("components/phone-modal/phone-modal")]).then(n.bind(null,"774d"))},sqModal:function(){return Promise.all([n.e("common/vendor"),n.e("components/sq-modal/sq-modal")]).then(n.bind(null,"3951"))},eModal:function(){return n.e("components/e-modal/e-modal").then(n.bind(null,"9fdf"))}},o=function(){var t=this,e=t.$createElement;t._self._c},i=[]}},[["01c7","common/runtime","common/vendor"]]]);