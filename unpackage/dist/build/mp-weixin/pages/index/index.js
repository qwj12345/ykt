(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"01c7":function(t,e,a){"use strict";(function(t){a("4ce3"),a("921b");n(a("66fd"));var e=n(a("d91a"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"1a87":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=r(a("ea00")),i=r(a("5ee3")),s=a("52e5");function r(t){return t&&t.__esModule?t:{default:t}}var d={data:function(){return{invitationCode:"",toastTitle:"",toastType:"ring",showChoose:!1,menus:[],swiperIndex:0,cWidth3:"",cHeight3:"",arcbarWidth:"",pixelRatio:1,list:["canvasArcbar1","canvasArcbar2"],studyColors:["background:rgb(199,234,251)","background:rgb(232,243,210)","background:rgb(250,204,229)","background:rgb(253,235,209)"],weeks:["周日","周一","周二","周三","周四","周五","周六"],nowDay:{month:"5月2020",day:"20",week:3},weather:"--",temphigh:"--",templow:"--",weatherImg:"http://level8cases.oss-cn-hangzhou.aliyuncs.com/weathercn02/29.png",students:[],canvasText:"0",avatarImg:[a("4a3a"),a("a95a")],showStudent:{},products:[],amSubjects:[],pmSubjects:[],showStudentId:0}},computed:{isLogin:function(){return this.$store.state.login}},watch:{isLogin:function(){this.isLogin&&this.getStudent()},showStudent:{handler:function(t,e){this.getSubject()},immediate:!0}},methods:{showSQ:function(){this.$refs.sq.toggle()},goPage:function(e){this.isLogin?-1!==e.search("editTable")&&0===this.students.length?(this.toastTitle="请先添加小孩",this.toastType="none",this.$refs.toast.showLoading()):t.navigateTo({url:e}):this.showSQ()},toggleChoose:function(){this.showChoose?this.showChoose=!1:this.showChoose=!0},chooseChild:function(t){this.showStudent._id!==t._id&&(this.showStudentId=t._id,this.toggleChoose(),this.getStudentDetail())},getScope:function(){var e=this;"--"===this.weather&&t.openSetting({success:function(t){t.authSetting["scope.userLocation"]&&e.getWeather("fd775be10a2b2f19a552105a2747c07f")}})},getStudent:function(){var t=this;this.myRequest("student/findStudent",{data:{},method:"GET",contentType:"application/json"}).then((function(e){200===e.data.code&&0!==e.data.data.length&&(t.students=e.data.data,t.showStudentId=e.data.data[0]._id,t.getStudentDetail())}))},getStudentDetail:function(){var t=this,e={id:this.showStudentId};this.$refs.loading.showLoading(),this.myRequest("student/findStudentDetail",{data:e,method:"GET"}).then((function(e){if(t.$refs.loading.hideLoading(),200===e.data.code){t.showStudent=e.data.data;var a=(0,s.dateDifference)(t.showStudent.startTime,(0,s.timeFormat1)(new Date,3))/(0,s.dateDifference)(t.showStudent.startTime,t.showStudent.endTime);t.canvasText=a>=1?"100":Math.round(100*a);var n={series:[{data:a>=1?1:a,color:a>=1?"rgb(232,56,58)":"rgb(255,255,255)"}]};t.showArcbar("canvas",n)}else t.toastType="error",t.toastTitle="请求错误",t.$refs.toast.showLoading()}))},getDate:function(){this.nowDay=(0,s.timeFormat1)(new Date,0),this.getSubject()},getWeather:function(e){var a=new o.default.AMapWX({key:e});a.getRegeo({success:function(e){var a=e[0].regeocodeData.addressComponent.streetNumber.location.split(",").reverse().join(",");t.request({url:"https://jisutqybmf.market.alicloudapi.com/weather/query?city='".concat(e[0].regeocodeData.addressComponent.district,"'&location=\"").concat(a,'"'),method:"GET",header:{Authorization:"APPCODE cbd4d9a3b71d4b078ab4e8cae480f29c","content-type":"application/x-www-form-urlencoded; charset=UTF-8"},success:function(t){n.weather=t.data.result.weather,n.temphigh=t.data.result.temphigh,n.templow=t.data.result.templow,n.weatherImg="http://level8cases.oss-cn-hangzhou.aliyuncs.com/weathercn02/"+t.data.result.img+".png"}})},fail:function(t){}})},showArcbar:function(t,e){new i.default({$this:n,canvasId:t,type:"arcbar",fontSize:11,legend:{show:!1},duration:2500,pixelRatio:n.pixelRatio,series:e.series,animation:!0,width:n.cWidth3*n.pixelRatio,height:n.cHeight3*n.pixelRatio,dataLabel:!0,extra:{arcbar:{type:"circle",width:n.arcbarWidth*n.pixelRatio,ringWidth:3,labelWidth:20,startAngle:.5}}})},getSubject:function(){var t=this;if(this.showStudent._id){var e=parseInt(0==this.nowDay.week?7:this.nowDay.week),a={studentId:this.showStudent._id};this.myRequest("table/findTableByStudent",{data:a,method:"GET"}).then((function(a){if(200===a.data.code){t.amSubjects=[],t.pmSubjects=[];var n=a.data.data;for(var o in n){var i=parseInt(o.slice(0,1));if(i===e&&e<6){var s=parseInt(o.slice(1,2));s<=4&&n[o]?t.amSubjects.push(n[o]):s>4&&n[o]&&t.pmSubjects.push(n[o])}}}else t.toastType="error",t.toastTitle="请求错误",t.$refs.toast.showLoading()}))}}},onShareAppMessage:function(e){t.showShareMenu({withShareTicket:!0})},onShow:function(){1===getApp().globalData.homeChildFlag&&(getApp().globalData.homeChildFlag=0,this.getStudent())},onLoad:function(e){n=this,this.cWidth3=t.upx2px(316),this.cHeight3=t.upx2px(316),this.arcbarWidth=t.upx2px(34),this.getWeather("fd775be10a2b2f19a552105a2747c07f"),this.getDate()}};e.default=d}).call(this,a("543d")["default"])},"2b0c":function(t,e,a){},3009:function(t,e,a){"use strict";a.r(e);var n=a("8267"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=o.a},"716b":function(t,e,a){"use strict";var n=a("2b0c"),o=a.n(n);o.a},8267:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={ip:"https://xc.frbkw.com/"};e.default=n},"83bf":function(t,e,a){"use strict";a.r(e);var n=a("1a87"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=o.a},b542:function(t,e,a){"use strict";a.r(e);var n=a("3009");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);var i,s,r,d,u=a("f0c5"),c=Object(u["a"])(n["default"],i,s,!1,null,null,null,!1,r,d);e["default"]=c.exports},d91a:function(t,e,a){"use strict";a.r(e);var n=a("dadf"),o=a("83bf");for(var i in o)"default"!==i&&function(t){a.d(e,t,(function(){return o[t]}))}(i);a("716b");var s,r=a("f0c5"),d=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=d.exports},dadf:function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n}));var n={wybLoading:function(){return a.e("components/wyb-loading/wyb-loading").then(a.bind(null,"faff"))},myToast:function(){return a.e("components/my-toast/my-toast").then(a.bind(null,"c38f"))},phoneModal:function(){return Promise.all([a.e("common/vendor"),a.e("components/phone-modal/phone-modal")]).then(a.bind(null,"774d"))},sqModal:function(){return Promise.all([a.e("common/vendor"),a.e("components/sq-modal/sq-modal")]).then(a.bind(null,"3951"))}},o=function(){var t=this,e=t.$createElement;t._self._c},i=[]}},[["01c7","common/runtime","common/vendor"]]]);